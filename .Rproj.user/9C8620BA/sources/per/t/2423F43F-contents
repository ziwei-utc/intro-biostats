---
title: "MATH 4140/5140"
subtitle: 'Lecture 6: Estimation'
author: "Ziwei Ma"
institute: "UTC"
date: "updated: `r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
bibliography: nonparamterics.bib
# header-includes:
#   \setbeamercolor{frametitle}{bg=red}
#   \hypersetup{colorlinks, citecolor=blue, filecolor=red, linkcolor=brown, urlcolor=blue}
# output: 
#   beamer_presentation:
#     theme: "Warsaw"
#     colortheme: "seahorse"
#     slide_level: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width = 3,fig.height = 3, fig.align="center")
```



# Confidence interval (Interval estimator)

- A procedure calculating an **interval**, $[\hat{\theta}_{L}, \hat{\theta}_{U}]$, of probable values of an unknown population parameter $\theta$ by using the sample measurements, $Y_{1}, \ldots, Y_{n}$.

  - its length and location are random quantities, as one or both of endpoints in the interval vary randomly from sample to sample: $$\hat{\theta}_{L}  = \hat{\theta}_{L} (Y_{1}, \ldots, Y_{n}), \hat{\theta}_{U}  = \hat{\theta}_{U} (Y_{1}, \ldots, Y_{n}).$$
  - indicate the **reliability of an estimate**, as it represents a range of values around an estimate that include $\theta$ (with a certain probability in repeated sampling)
  - $[\hat{\theta}_{L}, \hat{\theta}_{U}]$ are written with a percentage; what does this percentage represent?



---

## Confidence level, $100(1-\alpha)\%$

- Suppose one has a procedure generating an interval for $\theta$ with the confidence level $100(1-\alpha)\%$.
- An interval based on a single sample, $Y_{1}=y_{1}, \ldots, Y_{n}=y_{n}$, either contains the true value of $\theta$ or it does not.
- If the same procedure generating a confidence interval with the confidence level $100(1-\alpha)\%$ was **used many times** in repeated sampling, each interval would either contain or fail to contain the true value of $\theta$.
  But, the *percentage* of all intervals enclosing the true value of $\theta$ would be very close to $100(1-\alpha)\%$.

---

- We want to employ a procedure that can generate
  - a **narrower** confidence interval  for a fixed value of $(1-\alpha)$ 

  - a confidence interval  with a **higher value of $(1-\alpha)$** if the *lengths of the confidence intervals are the same*




---


- Types of confidence interval
    1. two-sided confidence interval, $[\hat{\theta}_{L}, \hat{\theta}_{U}]$
      - $\hat{\theta}_{L}$ and $\hat{\theta}_{U}$ : random lower and upper endpoint (i.e., confidence limit)
          - $1-\alpha = P(\hat{\theta}_{L} \leq \theta \leq \hat{\theta}_{U})$

    2. one-sided confidence interval
      - lower one-sided confidence interval, $[\hat{\theta}_{L}, \infty)$
          - $1-\alpha= P(\hat{\theta}_{L} \leq \theta)$
      - upper one-sided confidence interval, $(-\infty, \hat{\theta}_{U}]$
          - $1-\alpha= P(\theta \leq \hat{\theta}_{U} )$
![](two-tails.png)

---

## How to find confidence intervals?

### **Pivotal method**
### **large-sample method using the C.L.T**

---

##  Pivotal method

- Pivotal method based on a **pivotal quantity** having two characteristics
  1. it is a function of $Y_{1}, \ldots, Y_{n}$  and unknown $\theta$ where $\theta$ is the only unknown quantity,
  2. its probability distribution is known and does not depend on $\theta$ 
  
- Procedure of the pivotal method  
  - Step 1: Find a pivotal quantity $U \equiv U(Y_{1}, \ldots, Y_{n}, \theta)$.
  - Step 2: Given a value of $1-\alpha$, calculate $a$ and $b$ such that $$1-\alpha = P(a \leq U \leq b)$$ where $P(U \geq b) = P(U \leq a)=\alpha/2$. 
  - Step 3: Find $\hat{\theta}_{L}$ and $\hat{\theta}_{U}$ such that $$1-\alpha = P(a \leq U \leq b) = P(\hat{\theta}_{L} \leq \theta \leq \hat{\theta}_{U})$$ by change of location and/or scale of $U$. 

---

## Example

> ![](ex8-4.png)

---

## Example

> ![](ex8-5.png)



